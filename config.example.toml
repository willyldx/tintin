[bot]
name = "tintin-bot"
host = "0.0.0.0"
port = 8787
data_dir = "./data"
# Base directory for cloning git repos when using `tintin new` (relative paths are resolved from this config file)
github_repos_dir = "./data/repos"
log_level = "debug"
# 1=response only, 2=response+reasoning+events (no tool call output), 3=all messages
message_verbosity = 2

[db]
# sqlite (SQLAlchemy-style URL):
url = "sqlite+aiosqlite:///./data/tintin-bot.db"
echo = false

[security]
restrict_paths = false
# allow_roots = ["/dev/"]
# deny_globs = []
max_sessions_per_chat = 100000
max_concurrent_sessions_per_chat = 100000
# Optional allowlists (empty => allow all)
# telegram_allow_user_ids = [123456789]
# telegram_allow_chat_ids = [-1001234567890]
# telegram_require_admin = false
# slack_allow_user_ids = ["U012ABCDEF"]
# slack_allow_channel_ids = ["C012ABCDEF"]
# slack_allow_workspace_ids = ["T012ABCDEF"]

[codex]
binary = "codex"
sessions_dir = "~/.codex/sessions"
poll_interval_ms = 500
max_catchup_lines = 2000
timeout_seconds = 3600
env = { "CODEX_TELEMETRY" = "0" }

# Optional: enable Claude Code sessions via Telegram `/cc`
[claude_code]
binary = "claude"
sessions_dir = ".claude/sessions"
poll_interval_ms = 500
max_catchup_lines = 2000
timeout_seconds = 3600
env = {}

[[projects]]
id = "api"
name = "API Service"
path = "/srv/repos/api"

[[projects]]
id = "custom"
name = "Custom pathâ€¦"
path = "*"

[telegram]
token = "<FILL ME TELEGRAM BOT TOKEN>"
# Optional extra bots used only for sending to reduce rate limiting; first token above is still used for updates/webhooks.
# additional_bot_tokens = ["env:TELEGRAM_TOKEN_2", "env:TELEGRAM_TOKEN_3"]
mode = "poll"                    # webhook | poll
poll_timeout_seconds = 30
use_topics = true
max_chars = 3500
message_queue_interval_ms = 3000
rate_limit_msgs_per_sec = 1.0

[slack]
bot_token = "<FILL ME SLACK BOT TOKEN>"
signing_secret = "<FILL ME SLACK SINGING TOKEN>"
events_path = "/slack/events"
interactions_path = "/slack/interactions"
session_mode = "thread"
max_chars = 3000
rate_limit_msgs_per_sec = 1.0

[cloud]
enabled = false
provider = "local" # local | modal
public_base_url = "https://tintin.example.com"
log_relay_enabled = true # disable to fall back to log syncer polling
workspaces_dir = "./data/cloud/workspaces"
default_agent = "codex"
# 32+ bytes recommended; use env:VAR to keep secrets out of config.toml
secrets_key = "env:TINTIN_CLOUD_SECRETS_KEY"
keepalive_minutes = 10

[cloud.modal]
# Optional Modal settings (used when provider = "modal")
token_id = "env:MODAL_TOKEN_ID"
token_secret = "env:MODAL_TOKEN_SECRET"
# environment = "default"
# endpoint = "https://api.modal.com"
app_name = "tintin-cloud"
# Image must include Playwright + Codex + Claude Code preinstalled.
image = "debian:12"
# image_id = "" # optional override (snapshot image ID)
timeout_ms = 86400000
idle_timeout_ms = 86400000
request_timeout_ms = 60000
command_timeout_ms = 60000
block_network = false
cidr_allowlist = []
workspace_root = "/workspace/tintin"
codex_binary = "codex" # command inside the Modal image
claude_binary = "claude" # command inside the Modal image

[cloud.proxy]
# When users do not provide their own API keys/endpoints, Tintin uses this proxy.
enabled = false
shared_secret = "env:TINTIN_CLOUD_PROXY_SECRET"
token_ttl_ms = 3600000
openai_api_key = "env:TINTIN_OPENAI_API_KEY"
openai_base_url = "https://api.openai.com/v1"
anthropic_api_key = "env:TINTIN_ANTHROPIC_API_KEY"
anthropic_base_url = "https://api.anthropic.com"
anthropic_version = "2023-06-01"
openai_path = "/cloud/proxy/openai"
anthropic_path = "/cloud/proxy/anthropic"

[cloud.oauth]
callback_path = "/oauth/callback"

# GitHub App integration (installation-based auth).
# private_key must be base64-encoded PEM (not raw PEM).
# Example: export GITHUB_APP_PRIVATE_KEY_B64="$(base64 -w 0 < private-key.pem)"
[cloud.github_app]
app_id = "env:GITHUB_APP_ID"
app_slug = "your-app-slug"
private_key = "env:GITHUB_APP_PRIVATE_KEY_B64"
# api_base_url = "https://api.github.com"
# app_base_url = "https://github.com"

[cloud.oauth.gitlab]
client_id = "env:GITLAB_OAUTH_CLIENT_ID"
client_secret = "env:GITLAB_OAUTH_CLIENT_SECRET"
# scopes = ["read_api"]

[cloud.oauth.local]
authorize_url = "https://local-tintin.example.com/oauth/authorize"
token_url = "https://local-tintin.example.com/oauth/token"
api_base_url = "https://local-tintin.example.com/api"
scopes = ["repo:read"]

[cloud.ui]
path = "/ui"
token_secret = "env:TINTIN_CLOUD_UI_TOKEN_SECRET" # also used for tinc CLI tokens
token_ttl_ms = 86400000
s3_bucket = "env:TINTIN_CLOUD_UI_S3_BUCKET"
s3_region = "us-east-1"
s3_prefix = "tintin/ui"
s3_signed_url_ttl_ms = 300000

[playwright_mcp]
enabled = true
provider = "local" # "local" | "browserbase" | "hyperbrowser"
package = "@playwright/mcp@latest"
browser = "chrome"
host = "127.0.0.1"
port_start = 11000
port_end = 13000
snapshot_mode = "full"
image_responses = "allow"
headless = true
user_data_dir = "./data/playwright/profile"
output_dir = "./data/playwright/artifacts"
timeout_ms = 20000
# executable_path = "/path/to/chrome"

# Browserbase provider (cloud)
[playwright_mcp.browserbase]
api_key = "env:BROWSERBASE_API_KEY"
project_id = "env:BROWSERBASE_PROJECT_ID"
region = "us-west-2"
keep_alive = false
timeout_sec = 600
proxies = true
extension_id = ""
context_id = ""
# browser_settings = { timeout = 600 }
# user_metadata = { tintin_env = "prod" }

[playwright_mcp.hyperbrowser]
api_key = "env:HYPERBROWSER_API_KEY"
api_base_url = "https://api.hyperbrowser.ai"
# session_params = { solveCaptchas = true, useStealth = true } # raw Hyperbrowser session payload

[pinecone]
api_key = "<PINECONE_API_KEY>"
index = "tintin-snapshots"
dimension = 512

[cloud.snapshot_cleanup]
enabled = true
ttl_days = 30
keep_per_identity = 50
sweep_minutes = 360
